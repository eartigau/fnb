<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Comparateur de FNB</title>
<link rel="icon" type="image/x-icon" href="img/icon.ico">

  <!-- Styles -->
  <link rel="stylesheet" href="disnat-style.css">
  <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css">
  <link rel="stylesheet" href="https://cdn.datatables.net/responsive/2.5.0/css/responsive.dataTables.min.css">
  <link rel="stylesheet" href="https://cdn.datatables.net/colreorder/1.6.4/css/colReorder.dataTables.min.css">

  <style>
.tooltip {
  position: relative;  /* référence pour la tooltip */
  cursor: pointer;
}

.tooltip .tooltiptext {
  visibility: hidden;
  width: 30vw;            /* 50% de la largeur de la fenêtre */
  max-width: 400px;       /* limite maximale */
  background-color: #333;
  color: #fff;
  text-align: left;
  border-radius: 6px;
  padding: 6px 8px;
  position: absolute;     /* relatif à la cellule */
  z-index: 1000;

  font-size: 12px;
  line-height: 1.4em;
  white-space: normal;    /* autorise les retours à la ligne */
  word-wrap: break-word;

  bottom: 125%;           /* au-dessus de la cellule */
  left: 50%;
  transform: translateX(-50%);
  
  opacity: 0;
  transition: opacity 0.3s;
}

.tooltip:hover .tooltiptext {
  visibility: visible;
  opacity: 1;
}

    /* Harmoniser DataTables avec la charte disnat */
    table.dataTable {
      width: 100% !important;
      border-collapse: collapse;
      font-size: 0.95rem;
    }
    table.dataTable thead th {
      font-weight: 700;
      color: var(--muted);
      border-bottom: 2px solid rgba(13,27,26,0.04);
    }
    table.dataTable tbody td {
      border-bottom: 1px solid rgba(13,27,26,0.03);
    }
    table.dataTable tbody tr:hover td {
      background: rgba(0,0,0,0.01);
    }
    #colCheckboxes label {
      margin-right: 10px;
      font-size: 0.9rem;
      color: var(--muted);
    }
    #colCheckboxes input[type=checkbox] {
      margin-right: 4px;
    }
    .filters {
      margin-top: 5px;
    }
    .filters div {
      margin-bottom: 5px;
    }
    .filters label {
      font-size: 0.9rem;
      color: var(--muted);
      margin-right: 2px;
    }
    .filters input {
      padding: 2px 2px;
      border-radius: 6px;
      border: 1px solid #e6ebe8;
      width: 3ch;
    }
    .filters {
      display: grid;
      grid-template-columns: 1fr 1fr; /* 2 colonnes */
      gap: 8px 16px;
    }


    /* --- Grille 2x2 pour graphiques --- */
    .charts-container {
      display: grid;
      grid-template-columns: 1fr 1fr; /* 2 colonnes */
      grid-template-rows: auto auto;  /* 2 lignes */
      gap: 16px;                      /* espace entre graphiques */
      margin-top: 16px;
    }
    .chart-card {
      border: 1px solid rgba(0,0,0,0.1);
      border-radius: 6px;
      padding: 8px;
      box-sizing: border-box;
      background: white;
      aspect-ratio: 3/2; /* ratio largeur/hauteur */
    }
    .chart-card canvas {
      width: 100% !important;
      height: 100% !important;
    }
  </style>
</head>
<body>
  <div class="container">
    <header class="header">
      <div class="brand">
        <div class="logo">T</div>
        <h1>Comparateurs de FNB</h1>
      </div>
      <nav class="nav">
        <a href="Accueil.html ">Accueil</a>
        <a href="documentation.html">Documentation</a>
      </nav>
    </header>

    <div class="card">
      <p class="small">
        Ce tableau permet interactivement de trier, filtrer, afficher/masquer des colonnes qui donnent des informations sur les propriétés des FNB négociés à la Bourse de Toronto (TSX). Il est construit à partir des données publiquement disponibles sur yahoofinance. <b>Les informations données ici le sont à titre indicatif et des erreurs peuvent s'être glissées dans mes codes, vous êtes entièrement responsable de vos placements, vérifiez toutes les informations pertinentes avant d'investir!</b><br>
      </p>

      <table id="myTable" class="display nowrap table">
        <thead>
          <tr><th><span class="tooltip col-name">Ticker<span class="tooltiptext">Identifiant du FNB à la bourse de Toronto (TSX). Les FNB en USD sont identifiés par un -U à la fin.</span></span><br><small class="unit"></small></th><th><span class="tooltip col-name">Nom complet<span class="tooltiptext">Nom complet du FNB tel que retourné par yahoo finance.</span></span><br><small class="unit"></small></th><th><span class="tooltip col-name">Croissance<span class="tooltiptext">Taux de croissance annuel moyen du FNB (en %/an) sur la période considérée, calculé par régression linéaire sur le logarithme des prix. Les dividendes sont pris en compte et ajoutés à la valeur.</span></span><br><small class="unit">%/an</small></th><th><span class="tooltip col-name">Volatilité<span class="tooltiptext">RMS du résidu à la pente annuelle (en %/an) du FNB sur la période considérée, calculée comme l'écart-type des rendements logarithmiques annuels.</span></span><br><small class="unit">%/an</small></th><th><span class="tooltip col-name">Durée<span class="tooltiptext">Durée totale (en années) de la période considérée pour le calcul de la croissance et de la volatilité.</span></span><br><small class="unit">ans</small></th><th><span class="tooltip col-name">CroissanceSP500<span class="tooltiptext">Taux de croissance annuel moyen après avoir soustrait la croissance du S&P500 (en %/an) sur la période considérée, calculé par régression linéaire sur le logarithme des prix. Les dividendes sont pris en compte et ajoutés à la valeur. On peut interpréter cette valeur comme la surperformance (ou sous-performance si négatif) du FNB par rapport au S&P500.</span></span><br><small class="unit">%/an</small></th><th><span class="tooltip col-name">VolatilitéSP500<span class="tooltiptext">RMS du résidu à la pente annuelle du FNB divisé par la volatilité du S&P500 (en %/an) sur la période considérée. Une valeur de 100% aurait la même volatilité que le S&P500, une valeur inférieure à 100% indiquerait une volatilité moindre (plus stable) et une valeur supérieure à 100% indiquerait une volatilité plus élevée (plus risquée).</span></span><br><small class="unit">%/an</small></th><th><span class="tooltip col-name">q<span class="tooltiptext">Indice de qualité (sans unité) combinant la croissance ajustée du S&P500, la volatilité ajustée du S&P500, la durée et l'indice de Gini. Un indice plus élevé indique un meilleur compromis entre ces facteurs.</span></span><br><small class="unit"></small></th><th><span class="tooltip col-name">gini<span class="tooltiptext">Indice de Gini (sans unité) mesurant la diversification sectorielle du FNB. Une valeur de 0 indiquerait une diversification parfaite (toutes les secteurs également représentés), tandis qu'une valeur de 1 indique une concentration totale dans un seul secteur. L'information n'est pas toujours disponible et est mise à 1 par défaut dans ce cas (pire scénario). En pratique l'indice ne decend que rarement sous 0,5.</span></span><br><small class="unit"></small></th><th><span class="tooltip col-name">immobilier<span class="tooltiptext">Pourcentage (%) de l'allocation du FNB dans le secteur de l'immobilier.</span></span><br><small class="unit">%</small></th><th><span class="tooltip col-name">conso_cyclique<span class="tooltiptext">Pourcentage (%) de l'allocation du FNB dans le secteur de la consommation cyclique.</span></span><br><small class="unit">%</small></th><th><span class="tooltip col-name">matériaux<span class="tooltiptext">Pourcentage (%) de l'allocation du FNB dans le secteur des matériaux.</span></span><br><small class="unit">%</small></th><th><span class="tooltip col-name">conso_de_base<span class="tooltiptext">Pourcentage (%) de l'allocation du FNB dans le secteur de la consommation de base.</span></span><br><small class="unit">%</small></th><th><span class="tooltip col-name">technologie<span class="tooltiptext">Pourcentage (%) de l'allocation du FNB dans le secteur de la technologie.</span></span><br><small class="unit">%</small></th><th><span class="tooltip col-name">communication<span class="tooltiptext">Pourcentage (%) de l'allocation du FNB dans le secteur des services de communication.</span></span><br><small class="unit"></small></th><th><span class="tooltip col-name">finance<span class="tooltiptext">Pourcentage (%) de l'allocation du FNB dans le secteur des services financiers.</span></span><br><small class="unit"></small></th><th><span class="tooltip col-name">services_publics<span class="tooltiptext">Pourcentage (%) de l'allocation du FNB dans le secteur des services publics.</span></span><br><small class="unit"></small></th><th><span class="tooltip col-name">industriel<span class="tooltiptext">Pourcentage (%) de l'allocation du FNB dans le secteur industriel.</span></span><br><small class="unit"></small></th><th><span class="tooltip col-name">énergie<span class="tooltiptext">Pourcentage (%) de l'allocation du FNB dans le secteur de l'énergie.</span></span><br><small class="unit">%</small></th><th><span class="tooltip col-name">santé<span class="tooltiptext">Pourcentage (%) de l'allocation du FNB dans le secteur de la santé.</span></span><br><small class="unit">%</small></th></tr>

        </thead>
        <tbody>
          <tr><td><a href="BKCL_TO.html">BKCL.TO</a></td><td>Global X Enhanced Equal Weight Canadian Banks Covered Call ETF</td><td>18.96</td><td>4.62</td><td>2.27</td><td>0.94</td><td>102.8</td><td>9.88</td><td>1.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>100.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td></tr>
          <tr><td><a href="DRFC_TO.html">DRFC.TO</a></td><td>Desjardins RI Canada Multifactor - Net-Zero Emissions Pathway ETF</td><td>11.3</td><td>9.79</td><td>7.08</td><td>-0.47</td><td>111.0</td><td>-10.04</td><td>0.57</td><td>3.17</td><td>4.21</td><td>15.33</td><td>3.94</td><td>9.96</td><td>1.21</td><td>35.59</td><td>1.55</td><td>10.36</td><td>13.33</td><td>1.35</td></tr>
          <tr><td><a href="ESGA_TO.html">ESGA.TO</a></td><td>BMO MSCI Canada Selection Equity Index ETF</td><td>9.63</td><td>10.04</td><td>5.76</td><td>-1.84</td><td>104.62</td><td>-35.99</td><td>0.61</td><td>0.62</td><td>0.53</td><td>12.93</td><td>6.82</td><td>13.44</td><td>1.54</td><td>36.73</td><td>2.76</td><td>11.27</td><td>13.37</td><td>0.0</td></tr>
          <tr><td><a href="HURA_TO.html">HURA.TO</a></td><td>Global X Uranium Index ETF</td><td>28.79</td><td>20.51</td><td>6.44</td><td>17.17</td><td>224.97</td><td>210.49</td><td>0.95</td><td>0.0</td><td>0.0</td><td>0.48</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>15.58</td><td>4.59</td><td>79.35</td><td>0.0</td></tr>
          <tr><td><a href="XUSC_TO.html">XUSC.TO</a></td><td>iShares S&P 500 3% Capped Index ETF CAD Units</td><td>13.21</td><td>4.48</td><td>1.27</td><td>0.53</td><td>100.64</td><td>5.26</td><td>0.44</td><td>2.36</td><td>11.26</td><td>1.92</td><td>6.0</td><td>26.16</td><td>9.78</td><td>16.12</td><td>2.87</td><td>9.18</td><td>3.52</td><td>10.83</td></tr>
          <tr><td><a href="ZGLD_TO.html">ZGLD.TO</a></td><td>BMO Gold Bullion ETF (CAD Units)</td><td>35.59</td><td>3.49</td><td>1.63</td><td>21.81</td><td>85.28</td><td>0.0</td><td>1.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td></tr>
          <tr><td><a href="ZID_TO.html">ZID.TO</a></td><td>BMO MSCI India Selection Equity Index ETF</td><td>10.92</td><td>14.19</td><td>15.75</td><td>0.11</td><td>192.7</td><td>2.74</td><td>0.48</td><td>0.62</td><td>14.51</td><td>8.51</td><td>8.49</td><td>10.72</td><td>0.83</td><td>28.1</td><td>3.76</td><td>6.44</td><td>14.18</td><td>3.85</td></tr>
          <tr><td><a href="ZLU_TO.html">ZLU.TO</a></td><td>BMO Low Volatility US Equity ETF (CAD)</td><td>10.98</td><td>8.53</td><td>12.55</td><td>0.45</td><td>111.22</td><td>13.31</td><td>0.45</td><td>3.67</td><td>4.3</td><td>1.37</td><td>14.87</td><td>14.26</td><td>3.49</td><td>12.26</td><td>20.67</td><td>7.73</td><td>0.75</td><td>16.63</td></tr>
          <tr><td><a href="ZUQ_TO.html">ZUQ.TO</a></td><td>BMO MSCI USA High Quality Index ETF</td><td>14.41</td><td>7.49</td><td>10.95</td><td>3.51</td><td>95.34</td><td>99.17</td><td>0.61</td><td>0.0</td><td>3.05</td><td>1.67</td><td>8.21</td><td>34.6</td><td>15.29</td><td>11.55</td><td>0.0</td><td>10.5</td><td>0.26</td><td>14.87</td></tr>
          <tr><td><a href="ZWG_TO.html">ZWG.TO</a></td><td>BMO Global High Dividend Covered Call ETF</td><td>8.84</td><td>5.08</td><td>5.76</td><td>-2.62</td><td>52.92</td><td>-74.86</td><td>0.5</td><td>0.0</td><td>9.72</td><td>3.61</td><td>8.49</td><td>24.51</td><td>6.69</td><td>22.42</td><td>0.0</td><td>4.37</td><td>8.26</td><td>11.93</td></tr>
          <tr><td><a href="CINF_TO.html">CINF.TO</a></td><td>CI Global Infrastructure Private Pool - ETF C$ Series</td><td>9.24</td><td>4.03</td><td>5.39</td><td>-1.37</td><td>45.06</td><td>-37.01</td><td>0.78</td><td>11.71</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>1.74</td><td>0.0</td><td>38.24</td><td>28.64</td><td>19.66</td><td>0.0</td></tr>
          <tr><td><a href="DMEC_TO.html">DMEC.TO</a></td><td>Desjardins Canadian Equity Index ETF</td><td>22.08</td><td>3.2</td><td>1.52</td><td>8.54</td><td>76.0</td><td>102.12</td><td>0.57</td><td>1.8</td><td>3.67</td><td>16.88</td><td>3.19</td><td>9.71</td><td>2.12</td><td>32.48</td><td>2.71</td><td>11.26</td><td>15.95</td><td>0.21</td></tr>
          <tr><td><a href="EBNK_TO.html">EBNK.TO</a></td><td>Evolve European Banks Enhanced Yield ETF Hedged CAD</td><td>24.69</td><td>8.08</td><td>3.78</td><td>10.22</td><td>113.09</td><td>132.12</td><td>1.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>100.0</td><td>0.0</td><td>0.0</td><td>0.0</td><td>0.0</td></tr>
          <tr><td><a href="FCUV_TO.html">FCUV.TO</a></td><td>Fidelity U.S. Value ETF</td><td>18.79</td><td>5.8</td><td>5.37</td><td>8.21</td><td>64.73</td><td>199.25</td><td>0.58</td><td>0.0</td><td>3.71</td><td>9.25</td><td>0.0</td><td>27.02</td><td>2.71</td><td>19.66</td><td>8.33</td><td>13.45</td><td>0.0</td><td>15.86</td></tr>
          <tr><td><a href="VFV_TO.html">VFV.TO</a></td><td>Vanguard S&P 500 Index ETF</td><td>13.81</td><td>7.59</td><td>12.96</td><td>3.21</td><td>99.67</td><td>99.91</td><td>0.51</td><td>1.99</td><td>10.72</td><td>1.68</td><td>5.21</td><td>34.79</td><td>10.03</td><td>13.43</td><td>2.36</td><td>7.66</td><td>3.03</td><td>9.09</td></tr>
          <tr><td><a href="ZEA_TO.html">ZEA.TO</a></td><td>BMO MSCI EAFE Index ETF</td><td>6.37</td><td>7.14</td><td>11.69</td><td>-4.24</td><td>90.6</td><td>-135.8</td><td>0.41</td><td>2.08</td><td>8.72</td><td>5.59</td><td>7.72</td><td>9.28</td><td>5.65</td><td>23.79</td><td>3.32</td><td>19.34</td><td>3.38</td><td>11.12</td></tr>
          <tr><td><a href="ZGQ_TO.html">ZGQ.TO</a></td><td>BMO MSCI All Country World High Quality Index ETF</td><td>12.64</td><td>7.72</td><td>10.95</td><td>1.74</td><td>98.23</td><td>48.61</td><td>0.6</td><td>0.21</td><td>4.94</td><td>1.54</td><td>8.64</td><td>35.93</td><td>14.78</td><td>9.28</td><td>0.04</td><td>11.17</td><td>0.45</td><td>13.03</td></tr>
          <tr><td><a href="ZLB_TO.html">ZLB.TO</a></td><td>BMO Low Volatility Canadian Equity ETF</td><td>10.2</td><td>7.56</td><td>13.75</td><td>-0.51</td><td>100.81</td><td>-16.53</td><td>0.46</td><td>5.44</td><td>8.66</td><td>5.33</td><td>18.73</td><td>4.2</td><td>9.4</td><td>21.16</td><td>15.33</td><td>11.75</td><td>0.0</td><td>0.0</td></tr>
          <tr><td><a href="ZQQ_TO.html">ZQQ.TO</a></td><td>BMO Nasdaq 100 Equity Hedged to CAD Index ETF</td><td>16.1</td><td>10.06</td><td>15.75</td><td>5.28</td><td>136.55</td><td>141.2</td><td>0.76</td><td>0.23</td><td>13.22</td><td>1.23</td><td>4.95</td><td>53.83</td><td>15.72</td><td>0.38</td><td>1.47</td><td>3.81</td><td>0.51</td><td>4.65</td></tr>
          <tr><td><a href="ZWE_TO.html">ZWE.TO</a></td><td>BMO Europe High Dividend Covered Call Hedged to CAD ETF</td><td>6.47</td><td>7.36</td><td>10.12</td><td>-4.83</td><td>95.68</td><td>-143.11</td><td>0.34</td><td>0.0</td><td>12.02</td><td>6.55</td><td>10.01</td><td>6.45</td><td>5.72</td><td>22.13</td><td>5.4</td><td>11.76</td><td>8.11</td><td>11.84</td></tr>

        </tbody>
        <tfoot>
          <tr><th>Ticker</th><th>Nom complet</th><th>Croissance</th><th>Volatilité</th><th>Durée</th><th>CroissanceSP500</th><th>VolatilitéSP500</th><th>q</th><th>gini</th><th>immobilier</th><th>conso_cyclique</th><th>matériaux</th><th>conso_de_base</th><th>technologie</th><th>communication</th><th>finance</th><th>services_publics</th><th>industriel</th><th>énergie</th><th>santé</th></tr>
</tr>

        </tfoot>
      </table>

      <!-- Cases pour afficher/masquer les colonnes -->
      <div id="colCheckboxes" class="controls"></div>

      <!-- Filtres min/max -->
      <div class="controls filters">

        <div class="filter-item">
        <div><label>Croissance </label><input type="number" size = "5" id="minCroissance"></div>
        <div><label>&#x2192; </label><input type="number" size = "5" id="maxCroissance"></div><br>
        </div>
        
        <div class="filter-item">
        <div><label>Volatilité </label><input type="number" size = "5" id="minVolatilité"></div>
        <div><label>&#x2192; </label><input type="number" size = "5" id="maxVolatilité"></div><br>
        </div>
        
        <div class="filter-item">
        <div><label>Durée </label><input type="number" size = "5" id="minDurée"></div>
        <div><label>&#x2192; </label><input type="number" size = "5" id="maxDurée"></div><br>
        </div>
        
        <div class="filter-item">
        <div><label>CroissanceSP500 </label><input type="number" size = "5" id="minCroissanceSP500"></div>
        <div><label>&#x2192; </label><input type="number" size = "5" id="maxCroissanceSP500"></div><br>
        </div>
        
        <div class="filter-item">
        <div><label>VolatilitéSP500 </label><input type="number" size = "5" id="minVolatilitéSP500"></div>
        <div><label>&#x2192; </label><input type="number" size = "5" id="maxVolatilitéSP500"></div><br>
        </div>
        
        <div class="filter-item">
        <div><label>q </label><input type="number" size = "5" id="minq"></div>
        <div><label>&#x2192; </label><input type="number" size = "5" id="maxq"></div><br>
        </div>
        
        <div class="filter-item">
        <div><label>gini </label><input type="number" size = "5" id="mingini"></div>
        <div><label>&#x2192; </label><input type="number" size = "5" id="maxgini"></div><br>
        </div>
        
        <div class="filter-item">
        <div><label>immobilier </label><input type="number" size = "5" id="minimmobilier"></div>
        <div><label>&#x2192; </label><input type="number" size = "5" id="maximmobilier"></div><br>
        </div>
        
        <div class="filter-item">
        <div><label>conso_cyclique </label><input type="number" size = "5" id="minconso_cyclique"></div>
        <div><label>&#x2192; </label><input type="number" size = "5" id="maxconso_cyclique"></div><br>
        </div>
        
        <div class="filter-item">
        <div><label>matériaux </label><input type="number" size = "5" id="minmatériaux"></div>
        <div><label>&#x2192; </label><input type="number" size = "5" id="maxmatériaux"></div><br>
        </div>
        
        <div class="filter-item">
        <div><label>conso_de_base </label><input type="number" size = "5" id="minconso_de_base"></div>
        <div><label>&#x2192; </label><input type="number" size = "5" id="maxconso_de_base"></div><br>
        </div>
        
        <div class="filter-item">
        <div><label>technologie </label><input type="number" size = "5" id="mintechnologie"></div>
        <div><label>&#x2192; </label><input type="number" size = "5" id="maxtechnologie"></div><br>
        </div>
        
        <div class="filter-item">
        <div><label>communication </label><input type="number" size = "5" id="mincommunication"></div>
        <div><label>&#x2192; </label><input type="number" size = "5" id="maxcommunication"></div><br>
        </div>
        
        <div class="filter-item">
        <div><label>finance </label><input type="number" size = "5" id="minfinance"></div>
        <div><label>&#x2192; </label><input type="number" size = "5" id="maxfinance"></div><br>
        </div>
        
        <div class="filter-item">
        <div><label>services_publics </label><input type="number" size = "5" id="minservices_publics"></div>
        <div><label>&#x2192; </label><input type="number" size = "5" id="maxservices_publics"></div><br>
        </div>
        
        <div class="filter-item">
        <div><label>industriel </label><input type="number" size = "5" id="minindustriel"></div>
        <div><label>&#x2192; </label><input type="number" size = "5" id="maxindustriel"></div><br>
        </div>
        
        <div class="filter-item">
        <div><label>énergie </label><input type="number" size = "5" id="minénergie"></div>
        <div><label>&#x2192; </label><input type="number" size = "5" id="maxénergie"></div><br>
        </div>
        
        <div class="filter-item">
        <div><label>santé </label><input type="number" size = "5" id="minsanté"></div>
        <div><label>&#x2192; </label><input type="number" size = "5" id="maxsanté"></div><br>
        </div>
        
      </div>

      <!-- Grille des graphiques 2x2 -->
      <div class="charts-container">
        <div class="chart-card" id="chart1"></div>
        <div class="chart-card" id="chart2"></div>
        <div class="chart-card" id="chart3"></div>
        <div class="chart-card" id="chart4"></div>
      </div>
    </div>

    <footer class="footer">
      Mise à jour : 2025-10-24 13:56
    </footer>
  </div>

  <!-- jQuery + DataTables + extensions (CDN) -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
  <script src="https://cdn.datatables.net/responsive/2.5.0/js/dataTables.responsive.min.js"></script>
  <script src="https://cdn.datatables.net/colreorder/1.6.4/js/dataTables.colReorder.min.js"></script>

  <script>
    $(document).ready(function(){
      var table = $('#myTable').DataTable({
        responsive: true,
        colReorder: false,
        stateSave: true,
        pageLength: 10,
        lengthMenu: [5,10,25,50,100],
        order: [[0,'asc']],
        columnDefs: [
          { targets: [1,4], className: 'dt-center' },
          { targets: [0], visible: true },  
          { targets: [1,5,6,7,8,9,10,11,12,13,14,15,16,17,18], visible: false },
        ]
      });

      var colorFlags = {
          2: "desc",  // Croissance : plus grand = vert
          3: "asc",   // Volatilité : plus petit = vert
          4: "desc",  // Durée : plus grand = vert
          5: "desc",  // CroissanceSP500 : plus grand = vert
          6: "asc",   // VolatilitéSP500 : plus petit = vert
          7: "desc",  // q : plus grand = vert
          8: "asc",   // gini : plus petit = vert
          9: "desc",  // immobilier : plus grand = vert
          10: "desc",  // conso_cyclique : plus grand = vert
          11: "desc",  // matériaux : plus grand = vert
          12: "desc",  // conso_de_base : plus grand = vert
          13: "desc",  // technologie : plus grand = vert
          14: "desc",  // communication : plus grand = vert
          15: "desc",  // finance : plus grand = vert
          16: "desc",  // services_publics : plus grand = vert
          17: "desc",  // industriel : plus grand = vert
          18: "desc",  // énergie : plus grand = vert
          19: "desc",  // santé : plus grand = vert

      };

      function getColMinMax(colIdx) {
        var data = table.column(colIdx, { search: 'applied' }).data().map(Number).toArray();
        var min = Math.min.apply(null, data);
        var max = Math.max.apply(null, data);
        return {min:min, max:max};
      }

      function valueToColor(val, min, max, flag) {
        if (isNaN(val) || max === min) return "inherit";
        var ratio = (val - min) / (max - min);
        if(flag === "asc") { ratio = 1 - ratio; }
        var r = Math.round(255 * (1 - ratio));
        var g = Math.round(180 * ratio);
        var b = Math.round(100 * ratio);
        return "rgb(" + r + "," + g + "," + b + ")";
      }

      table.on('draw', function(){
        Object.keys(colorFlags).forEach(function(idx){
          var flag = colorFlags[idx];
          var mm = getColMinMax(idx);
          table.column(idx, {page:'current'}).nodes().each(function(td){
            var val = parseFloat($(td).text()); // valeur numérique de la cellule
            $(td).css("color", valueToColor(val, mm.min, mm.max, flag));
          });
        });
      });


      table.draw();

      function buildColCheckboxes() {
        var container = $('#colCheckboxes').empty();
        table.columns().every(function(idx){
          var col = this;
          // Cherche le texte du nom (priorité à .col-name)
          var name = $(col.footer()).find('.col-name').text().trim();
          if (!name) { // fallback si pas de .col-name
            name = $(col.footer()).clone()   // copie du footer
                    .children('.unit').remove().end() // enlève .unit
                    .text().trim();
          }
          if(idx === 0) {
            container.append('<label><input type="checkbox" checked disabled/> '+name+'</label>');
          } else {
            var checked = col.visible() ? 'checked' : '';
            var $cb = $('<label><input type="checkbox" data-col="'+idx+'" '+checked+'/> '+name+'</label>');
            container.append($cb);
          }
        });
      }

      buildColCheckboxes();

      $('#colCheckboxes').on('change','input[type=checkbox]', function(){
        var idx = $(this).data('col');
        table.column(idx).visible(this.checked);
      });

      $.fn.dataTable.ext.search.push(function(settings, data){

                var minCroissance = parseFloat($('#minCroissance').val(),10);
                var maxCroissance = parseFloat($('#maxCroissance').val(),10);
                var Croissance = parseFloat(data[2]) || 0;
        
                var minVolatilité = parseFloat($('#minVolatilité').val(),10);
                var maxVolatilité = parseFloat($('#maxVolatilité').val(),10);
                var Volatilité = parseFloat(data[3]) || 0;
        
                var minDurée = parseFloat($('#minDurée').val(),10);
                var maxDurée = parseFloat($('#maxDurée').val(),10);
                var Durée = parseFloat(data[4]) || 0;
        
                var minCroissanceSP500 = parseFloat($('#minCroissanceSP500').val(),10);
                var maxCroissanceSP500 = parseFloat($('#maxCroissanceSP500').val(),10);
                var CroissanceSP500 = parseFloat(data[5]) || 0;
        
                var minVolatilitéSP500 = parseFloat($('#minVolatilitéSP500').val(),10);
                var maxVolatilitéSP500 = parseFloat($('#maxVolatilitéSP500').val(),10);
                var VolatilitéSP500 = parseFloat(data[6]) || 0;
        
                var minq = parseFloat($('#minq').val(),10);
                var maxq = parseFloat($('#maxq').val(),10);
                var q = parseFloat(data[7]) || 0;
        
                var mingini = parseFloat($('#mingini').val(),10);
                var maxgini = parseFloat($('#maxgini').val(),10);
                var gini = parseFloat(data[8]) || 0;
        
                var minimmobilier = parseFloat($('#minimmobilier').val(),10);
                var maximmobilier = parseFloat($('#maximmobilier').val(),10);
                var immobilier = parseFloat(data[9]) || 0;
        
                var minconso_cyclique = parseFloat($('#minconso_cyclique').val(),10);
                var maxconso_cyclique = parseFloat($('#maxconso_cyclique').val(),10);
                var conso_cyclique = parseFloat(data[10]) || 0;
        
                var minmatériaux = parseFloat($('#minmatériaux').val(),10);
                var maxmatériaux = parseFloat($('#maxmatériaux').val(),10);
                var matériaux = parseFloat(data[11]) || 0;
        
                var minconso_de_base = parseFloat($('#minconso_de_base').val(),10);
                var maxconso_de_base = parseFloat($('#maxconso_de_base').val(),10);
                var conso_de_base = parseFloat(data[12]) || 0;
        
                var mintechnologie = parseFloat($('#mintechnologie').val(),10);
                var maxtechnologie = parseFloat($('#maxtechnologie').val(),10);
                var technologie = parseFloat(data[13]) || 0;
        
                var mincommunication = parseFloat($('#mincommunication').val(),10);
                var maxcommunication = parseFloat($('#maxcommunication').val(),10);
                var communication = parseFloat(data[14]) || 0;
        
                var minfinance = parseFloat($('#minfinance').val(),10);
                var maxfinance = parseFloat($('#maxfinance').val(),10);
                var finance = parseFloat(data[15]) || 0;
        
                var minservices_publics = parseFloat($('#minservices_publics').val(),10);
                var maxservices_publics = parseFloat($('#maxservices_publics').val(),10);
                var services_publics = parseFloat(data[16]) || 0;
        
                var minindustriel = parseFloat($('#minindustriel').val(),10);
                var maxindustriel = parseFloat($('#maxindustriel').val(),10);
                var industriel = parseFloat(data[17]) || 0;
        
                var minénergie = parseFloat($('#minénergie').val(),10);
                var maxénergie = parseFloat($('#maxénergie').val(),10);
                var énergie = parseFloat(data[18]) || 0;
        
                var minsanté = parseFloat($('#minsanté').val(),10);
                var maxsanté = parseFloat($('#maxsanté').val(),10);
                var santé = parseFloat(data[19]) || 0;
        
        if (
            (isNaN(minCroissance) || Croissance >= minCroissance)  && 
            (isNaN(maxCroissance) || Croissance <= maxCroissance)  && 
            (isNaN(minVolatilité) || Volatilité >= minVolatilité)  && 
            (isNaN(maxVolatilité) || Volatilité <= maxVolatilité)  && 
            (isNaN(minDurée) || Durée >= minDurée)  && 
            (isNaN(maxDurée) || Durée <= maxDurée)  && 
            (isNaN(minCroissanceSP500) || CroissanceSP500 >= minCroissanceSP500)  && 
            (isNaN(maxCroissanceSP500) || CroissanceSP500 <= maxCroissanceSP500)  && 
            (isNaN(minVolatilitéSP500) || VolatilitéSP500 >= minVolatilitéSP500)  && 
            (isNaN(maxVolatilitéSP500) || VolatilitéSP500 <= maxVolatilitéSP500)  && 
            (isNaN(minq) || q >= minq)  && 
            (isNaN(maxq) || q <= maxq)  && 
            (isNaN(mingini) || gini >= mingini)  && 
            (isNaN(maxgini) || gini <= maxgini)  && 
            (isNaN(minimmobilier) || immobilier >= minimmobilier)  && 
            (isNaN(maximmobilier) || immobilier <= maximmobilier)  && 
            (isNaN(minconso_cyclique) || conso_cyclique >= minconso_cyclique)  && 
            (isNaN(maxconso_cyclique) || conso_cyclique <= maxconso_cyclique)  && 
            (isNaN(minmatériaux) || matériaux >= minmatériaux)  && 
            (isNaN(maxmatériaux) || matériaux <= maxmatériaux)  && 
            (isNaN(minconso_de_base) || conso_de_base >= minconso_de_base)  && 
            (isNaN(maxconso_de_base) || conso_de_base <= maxconso_de_base)  && 
            (isNaN(mintechnologie) || technologie >= mintechnologie)  && 
            (isNaN(maxtechnologie) || technologie <= maxtechnologie)  && 
            (isNaN(mincommunication) || communication >= mincommunication)  && 
            (isNaN(maxcommunication) || communication <= maxcommunication)  && 
            (isNaN(minfinance) || finance >= minfinance)  && 
            (isNaN(maxfinance) || finance <= maxfinance)  && 
            (isNaN(minservices_publics) || services_publics >= minservices_publics)  && 
            (isNaN(maxservices_publics) || services_publics <= maxservices_publics)  && 
            (isNaN(minindustriel) || industriel >= minindustriel)  && 
            (isNaN(maxindustriel) || industriel <= maxindustriel)  && 
            (isNaN(minénergie) || énergie >= minénergie)  && 
            (isNaN(maxénergie) || énergie <= maxénergie)  && 
            (isNaN(minsanté) || santé >= minsanté)  && 
            (isNaN(maxsanté) || santé <= maxsanté) 
        ) {
          return true;
        }
        return false;
      });

      $('#minCroissance,#maxCroissance,#minVolatilité,#maxVolatilité,#minDurée,#maxDurée,#minCroissanceSP500,#maxCroissanceSP500,#minVolatilitéSP500,#maxVolatilitéSP500,#minq,#maxq,#mingini,#maxgini,#minimmobilier,#maximmobilier,#minconso_cyclique,#maxconso_cyclique,#minmatériaux,#maxmatériaux,#minconso_de_base,#maxconso_de_base,#mintechnologie,#maxtechnologie,#mincommunication,#maxcommunication,#minfinance,#maxfinance,#minservices_publics,#maxservices_publics,#minindustriel,#maxindustriel,#minénergie,#maxénergie,#minsanté,#maxsanté').on('keyup change', function(){
        table.draw();
      });
    });
  </script>
</body>
</html>